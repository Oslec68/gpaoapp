
<!DOCTYPE html>
<html lang="pt-BR">
<head><meta charset="UTF-8"><meta name="viewport" content="width=device-width,initial-scale=1"><title>Visita GPA</title>
<script src="https://telegram.org/js/telegram-web-app.js"></script>
<style>
body { font:16px sans-serif; padding:20px; }
section { margin-bottom:20px; }
label { font-weight:bold; margin-top:8px; display:block; }
input,textarea { width:100%; padding:8px; margin-top:4px; box-sizing:border-box; }
button { width:100%; padding:12px; background:#0088cc; color:#fff; border:none; border-radius:6px; cursor:pointer; }
.checks { display:flex; flex-wrap:wrap; gap:10px; }
.checks label { flex:1 0 45%; display:flex; align-items:center; gap:8px; }
</style></head>
<body>
<h2>ðŸ›’ Visita GPA</h2>
<section><label>UsuÃ¡rio Telegram:</label><input id="usuario" readonly></section>
<section><label>CÃ³digo da Loja (4 dÃ­gitos):</label><input id="cod" maxlength="4" placeholder="Ex: 0412"></section>
<section><label>Checklist:</label>
  <div class="checks">
    <label><input type="checkbox" value="Ruptura"> Ruptura</label>
    <label><input type="checkbox" value="PreÃ§o errado"> PreÃ§o errado</label>
    <label><input type="checkbox" value="Limpeza"> Limpeza</label>
    <label><input type="checkbox" value="Atendimento"> Atendimento</label>
  </div>
</section>
<section><label>ObservaÃ§Ãµes:</label><textarea id="obs" rows="4" placeholder="Digite algo..."></textarea></section>
<button id="btnEnviar">âœ… Enviar Visita</button>
<script>
const tg = window.Telegram.WebApp;
tg.expand(); tg.ready();
const usuario = tg.initDataUnsafe?.user?.first_name || "";
document.getElementById("usuario").value = usuario;
document.getElementById("btnEnviar").onclick = () => {
  const cod = document.getElementById("cod").value.trim();
  if (cod.length !== 4) return alert("CÃ³digo da loja precisa ter 4 dÃ­gitos.");
  const checklist = [...document.querySelectorAll('.checks input:checked')].map(c=>c.value);
  const obs = document.getElementById("obs").value.trim();
  tg.sendData(JSON.stringify({ loja: cod, usuario, checklist, observacoes: obs }));
  tg.close();
};
</script>
</body>
</html>
